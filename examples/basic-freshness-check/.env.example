# FreshGuard Core v0.2.0 - Secure Monitoring Example Configuration
#
# Updated for Phase 2 Security Implementation with enterprise-grade features
# Copy this file to .env and adjust the values for your setup
# cp .env.example .env

# Database Configuration (SSL enforced by default)
# Default values work with the included docker-compose.yml
DB_HOST=localhost
DB_PORT=5432
DB_NAME=freshguard_example
DB_USER=freshguard_user
DB_PASSWORD=freshguard_password

# Legacy format (still supported but individual env vars are preferred):
# DATABASE_URL=postgresql://freshguard_user:freshguard_password@localhost:5432/freshguard_example

# Security Configuration (Phase 2 Features)
# Query complexity analysis settings
FRESHGUARD_MAX_RISK_SCORE=70               # Block queries above this risk score (0-100)
FRESHGUARD_MAX_COMPLEXITY_SCORE=80         # Block overly complex queries (0-100)
FRESHGUARD_ENABLE_QUERY_ANALYSIS=true      # Enable SQL injection & complexity analysis

# SSL/TLS Security
FRESHGUARD_REQUIRE_SSL=true                # Enforce SSL connections (production: true)
FRESHGUARD_SSL_CERT_PATH=/etc/ssl/certs/db.crt   # Optional: Custom SSL certificate

# Connection Security
FRESHGUARD_CONNECTION_TIMEOUT=30000        # Connection timeout in milliseconds
FRESHGUARD_QUERY_TIMEOUT=10000            # Query execution timeout in milliseconds
FRESHGUARD_MAX_ROWS=1000                  # Maximum rows per query result

# Circuit Breaker & Resilience
FRESHGUARD_CIRCUIT_BREAKER_ENABLED=true   # Enable circuit breaker protection
FRESHGUARD_RETRY_ATTEMPTS=3               # Number of retry attempts
FRESHGUARD_RETRY_BACKOFF=1000             # Retry backoff in milliseconds

# Production Security Examples (uncomment for production):
#
# For production PostgreSQL with strict security:
# DB_HOST=secure-db.production.com
# DB_USER=freshguard_readonly               # Use read-only database user
# DB_PASSWORD=${VAULT_DB_PASSWORD}          # From secure vault (e.g., HashiCorp Vault)
# FRESHGUARD_MAX_RISK_SCORE=50              # Stricter in production
# FRESHGUARD_ENABLE_DETAILED_LOGGING=false  # Reduce log volume
#
# For PostgreSQL with mutual TLS:
# FRESHGUARD_SSL_CLIENT_CERT=/etc/ssl/client.crt
# FRESHGUARD_SSL_CLIENT_KEY=/etc/ssl/client.key
# FRESHGUARD_SSL_CA_CERT=/etc/ssl/ca.crt

# Monitoring Configuration (optional - can be set in the scripts instead)
# FRESHNESS_TOLERANCE_MINUTES=60
# VOLUME_CHECK_INTERVAL_MINUTES=10

# Alert Configuration (for future expansion)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
# EMAIL_SMTP_HOST=smtp.gmail.com
# EMAIL_SMTP_PORT=587
# EMAIL_FROM=alerts@yourcompany.com
# EMAIL_TO=team@yourcompany.com

# Logging Configuration
# LOG_LEVEL=info
# LOG_FORMAT=json

# Performance Tuning
# DB_POOL_SIZE=10
# DB_TIMEOUT_MS=30000